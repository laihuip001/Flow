# 📱 AI Clipboard Pro v3.0.1 ユーザーズガイド (Windows 11 & ColorOS 15)

このガイドでは、あなたの **Windows 11 PCを「AI頭脳サーバー」** とし、**ColorOS 15 (OPPO/OnePlus) スマホを「リモコン」** として使う方法を解説します。

---

## 🖥️ STEP 1: Windows 11 (サーバー側) の準備

PCは「AIの処理」を担当します。

### 1. サーバーの起動

まだ起動していない場合は、PowerShellで以下を実行します。

```powershell
cd C:\Users\IT_USER\Desktop\drive-download-20260104T003235Z-1-001\prompt-engineering-library
python main.py
```

### 2. PCのIPアドレスを確認

スマホから接続するために、PCの「住所」が必要です。

1. 新しいPowerShellウィンドウを開く。
2. `ipconfig` と入力してEnter。
3. **IPv4 アドレス** の数字をメモしてください。（例: `192.168.1.15`）

> **💡 ヒント:** スマホとPCは同じWi-Fiに接続している必要があります。

---

## 📱 STEP 2: ColorOS 15 (クライアント側) の設定

スマホは「テキストの送信と受信」を担当します。
Android最強の自動化アプリ **「HTTP Shortcuts」** を使用します。

### 1. アプリのインストール

Google Playストアから **[HTTP Shortcuts](https://play.google.com/store/apps/details?id=ch.rmy.android.http_shortcuts)** をインストールしてください。（無料・広告なし）

### 2. 「ビジネス変換」ショートカットの作成

アプリを開き、`+` ボタンから「新しいショートカット」を作成します。

#### **基本設定**

- **名前:** `ビジネス変換` (好きな名前でOK)
- **アイコン:** スーツケースなど分かりやすいものに変更

#### **一般設定**

- **実行方法:** 「エディタ＆ウィンドウで開く」または「トーストを表示」

#### **リクエスト設定**

- **URL:** `http://[PCのIPアドレス]:8000/process`
  - 例: `http://192.168.1.15:8000/process`
- **メソッド:** `POST`

#### **ヘッダー (認証用)**

「ヘッダーを追加」をタップします。

- **キー:** `Authorization`
- **値:** `Bearer your_secret_token_here`
  - ※ `.env` の `API_TOKEN` と同じ値を入れてください

#### **ボディ (送信データ)**

「ボディ種類」を `application/json` にし、以下を入力します：

```json
{
  "text": "{clipboard}",
  "style": "business"
}
```

> **📌 ポイント:** `{clipboard}` は、スマホのクリップボードの中身を自動挿入する魔法の変数です。

---

## 💻 PC (Windows 11) での使い方

PCで作業中もAIクリップボードを活用できます。便利な順に3つの方法があります。

### 方法1: Web GUI (新機能！最もオススメ) 🌐

ブラウザから直感的に操作できる管理画面です。

1. **<http://localhost:8000/gui>** をブラウザで開く
   - ブックマークしておくと便利です！
2. 画面上のボタンで **スタイルを選択** (ビジネス、カジュアル等)
3. **⚙️ 詳細設定 (New)** をクリックして調整可能:
   - **温度スライダー**: AIの創造性を調整（左=正確、右=創造的）
   - **Pre-Fetch (先読み)**: ボタンを押すと、裏で全スタイルの回答を準備（待ち時間ゼロへ）
4. 変換したいテキストを **入力または貼り付け**
5. **「✨ 変換する」** ボタンをクリック
6. 結果を確認して **「📋 結果をコピー」** ボタンで取得

> **機能:** 個人情報(PII)スキャンやサーバー状態チェックもこの画面から行えます。

### 方法2: デスクトップ用バッチファイル (ボタン感覚) ⚡

デスクトップに置いておけば、ダブルクリックだけで「コピー → 変換 → クリップボード更新」が一瞬で完了します。

**用意されたバッチ:**

- `AI_Analyze.bat` : **🧩 コンポーネント抽出**（記事からデータベース行を生成）
- `AI_Enhance.bat` : **🧠 プロンプト強化**（指示をCoT付きの高度なプロンプトへ）
- `AI_Structure.bat` : **🏗️ 構造化**（メモをMOC向けMarkdownに整形）
- `AI_Summary.bat` : **📝 要約**（箇条書きでシンプルに）
- `AI_Proofread.bat` : **🔍 校正**（誤字脱字チェックのみ）

**使い方:**

1. 変換したいテキストを普通にコピー (Ctrl+C)
2. デスクトップ等のアイコンを **ダブルクリック**
3. 自動で処理が走り、完了するとクリップボードが新しい内容に変わります
4. そのまま貼り付け (Ctrl+V)

### 方法3: クリップボード変換スクリプト (詳細設定向け) 🔧

付属の `ai_convert.ps1` を使うと、PowerShellから直接変換を実行できます。

#### **初回のみ: 実行許可の設定**

Windowsのセキュリティ設定により、利用前に以下のコマンドを1回実行してください：

```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

（「Y」を入力してEnter）

#### **普段の使い方**

1. テキストをコピーする（Ctrl+C）
2. 以下のコマンドを実行（例：構造化したい場合）

```powershell
.\ai_convert.ps1 -Style "structure_data"
```

1. クリップボードが更新されます。

---

## 🚀 STEP 3: 実際に使ってみる

ColorOS 15 の便利な機能を活用して、爆速でAIを呼び出しましょう。

### シナリオ: 「この記事のコンポーネントを抽出したい」と思った時

1. **PCでサーバー起動中**であることを確認。
2. スマホで、技術記事のURLや本文を **コピー** します。
3. ホーム画面に追加した **「Analyze」ショートカット** をタップします。
4. 数秒待つと...
5. Obsidianに貼り付け可能な **Markdownテーブル** (`| Link | Component ...`) が返ってきます！

---

## 🎨 ColorOS 15 活用テクニック

（省略：前述の通り）

---

## ⚠️ トラブルシューティング

**Q. 「接続できません」と言われる**

- PCとスマホが同じWi-Fiに繋がっていますか？
- PCのファイアウォール設定を確認してください。
- IPアドレスが変わっていませんか？（`ipconfig` で再確認）

**Q. 「401 Unauthorized」エラー**

- ヘッダーの `Bearer` トークンが `.env` の `API_TOKEN` と一致していません。

---

## 🛠️ スタイルのカスタマイズ

ボディの `"style"` を書き換えることで、別の変換が可能です。

| 値 | 効果 |
|---|---|
| `"analyze_component"` | プロンプト技術のコンポーネント抽出 |
| `"reasoning_enhancer"` | 思考プロセス(CoT)の追加と具体化 |
| `"structure_data"` | 構造化されたMarkdownへの整形 |
| `"summary"` | 箇条書き要約 |
| `"proofread"` | 校正 |

これらを活用して、独自のショートカットを作成してください。
