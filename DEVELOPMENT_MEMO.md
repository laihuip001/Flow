# 📜 AI Clipboard Pro 開発備忘録 (v1.0 ~ v2.5)

## 🎯 プロジェクトの目的

**「スマホでの思考と入力を、アプリ切り替えなしで『最強のプロンプト』や『完成された文章』に変換する」**

単なる自動返信ツールではなく、ユーザーの意図を汲み取り、LLM（Gemini）の能力を最大限引き出すための「下処理・構造化」を行う**中間レイヤー（ミドルウェア）**の構築。

---

## 🏗️ システム構成 (Architecture)

### 1. Backend (脳みそ & 司令塔)

**技術:** Python (FastAPI, SQLAlchemy, Google Generative AI SDK)

**環境:**

- Google Colab (開発・実験)
- Termux (スマホ内完結)
- PC (母艦)

**主要モジュール:**

| ファイル | 役割 |
|---------|------|
| `main.py` | APIの入り口。同期・非同期リクエストの振り分け |
| `logic.py` | AIロジックの中枢 |
| `models.py` | データベースとAPIのデータ構造定義 |
| `config.py` | APIキーやモデル設定の管理 |
| `database.py` | SQLite接続管理 |

**logic.py の核心機能:**

- **Context Ballast:** アプリ名(`com.slack`等)から文脈（トーン、形式）を自動決定
- **Privacy Wrap:** 個人情報をタグ(`<EMAIL_1>`等)に置換して保護
- **Info Valve:** 文字数に応じて「要約」か「補完」かを自動制御

### 2. Frontend (インターフェース)

**技術:** Androidアプリ (HTTP Shortcuts, MacroDroid)

**役割:** ユーザーの操作を検知し、Backendにデータを投げる

| アプリ | 機能 |
|-------|------|
| HTTP Shortcuts | テキスト選択メニューやホーム画面に「実行ボタン」を設置 |
| MacroDroid | クリップボード変更やWi-Fi状態を検知し、自動で通信・切り替え |

### 3. Connection (つなぐ技術)

- **ngrok / Cloudflare Tunnel:** 外部からローカルサーバーへのトンネリング
- **フェイルオーバー:** PCへの接続失敗時、即座にスマホ内部(Termux)へ切り替え

---

## 📅 実装の変遷 (History)

| Version | 実装内容 | 目的・価値 |
|---------|----------|-----------|
| v1.0 | Prompt Builder | プロンプト技術の部品化とPythonコードによる生成 |
| v2.0 | API Server化 | スマホからHTTP通信で呼び出せるようにし、実用化 |
| v2.1 | Privacy / Valve / Slider | プライバシー保護、情報量制御、創造性調整を追加 |
| v2.2 | Preset System | よく使う設定（メール用など）を保存・呼出可能に |
| v2.3 | Output Control | 出力形式（Markdown/JSON）や口調の制御を追加 |
| v2.4 | Pre-Fetch (先読み) | コピーした瞬間に裏で処理を開始し、待ち時間をゼロに |
| v2.5 | Context Ballast | 開いているアプリに応じて設定を自動切り替え |

---

## ✅ 現在できること (Current Capabilities)

1. **選択してポン:** テキスト選択メニューから、その場に最適な形式（メール、コード、要約）に変換
2. **空気読み:** Slackならフランクに、Gmailなら丁寧に、勝手にキャラ変
3. **未来予知:** コピーした瞬間、裏でAIが「たぶんこう変換したいだろう」と予測して準備完了
4. **鉄壁の守り:** PCが落ちていてもスマホ単体で動作。個人情報は漏らさない

---

## 📂 ドキュメント一覧

| ファイル | 内容 |
|---------|------|
| `ANDROID_SETUP.md` | Android設定手順（HTTP Shortcuts / MacroDroid） |
| `TERMUX_SETUP.md` | Termux構築手順（ワンクリックインストール） |
| `HYBRID_SETUP.md` | PC + Termux ハイブリッド構成 + フェイルオーバー |
| `DEPLOYMENT.md` | デプロイオプション（Render, Cloudflare等） |
| `COLAB_SETUP.md` | Google Colab実行ガイド |
| `CHANGELOG.md` | バージョン履歴 |

---

## 🔮 次のステージへ：未来の構想

### 発見された「偏り」と「伸びしろ」

| Bias (偏り) | Opportunity (伸びしろ) |
|------------|----------------------|
| 効率・スピード・正解への偏り | **寄り道モード** - 別の視点や哲学的な問いを投げかける |
| テキストへの過度な依存 | **マルチモーダル** - 画像解析、音声転写 |
| 個人（Solo）への偏り | **相手プロファイル** - 連絡先と連携した文脈調整 |
| 受動的（Wait-for-Input）なスタンス | **文脈の継続性** - 直近のコピー履歴を短期記憶として保持 |
| 現在（Now）という時間軸への固定 | **インキュベーター** - アイデアを寝かせて育てる機能 |

### 特に掘り下げるべきテーマ

1. **洞察モード:** 効率だけでなく「気づき」を与える
2. **視覚入力:** 画像 → テキスト変換（Gemini Vision）
3. **文脈の継続性:** いかに知能(Gemini)にうまく文脈を共有するか
4. **能動的提案:** 道具の方からユーザーに働きかける
5. **インキュベーター:** 思いつきを企画に育てる

---

## 🎯 思想的アップデートの方向性

**「ツール（道具）」から「エコシステム（環境）」へ**

1. 脱・効率至上主義 → 創造性を刺激する寄り道
2. 脱・テキスト → 目（カメラ）や耳（マイク）を持たせる
3. 脱・孤独 → 他者（連絡先）や過去（履歴）との繋がり
4. 脱・受動 → 道具の方から働きかけてくる

---

この「堅牢な基盤」の上に、**「洞察」「視覚」「文脈」「育成」**という人間的な要素を載せていく。
